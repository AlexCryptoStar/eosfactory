<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python teos: Example &quot;Currency&quot; Contract Walkthrough</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python teos
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Provides a Python implementation of the tokenika TEOS. TEOS is a command-line interface to the EOSIO daemon.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Example "Currency" Contract Walkthrough </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>EOS comes with example contracts that can be uploaded and run for testing purposes. We will validate our single node setup using the sample contract 'currency'.</p>
<p>### Start EOS node </p><div class="fragment"><div class="line">import teos</div><div class="line">teos.set_verbose(False)</div><div class="line"></div><div class="line">daemon = teos.Daemon()</div><div class="line">daemon.clear()</div><div class="line">#       nodeos exe file: /mnt/e/Workspaces/EOS/eos/build/programs/nodeos/nodeos</div><div class="line">#    genesis state file: /mnt/e/Workspaces/EOS/eos/build/programs/daemon/data-dir/genesis.json</div><div class="line">#        server address: 127.0.0.1:8888</div><div class="line">#      config directory: /mnt/e/Workspaces/EOS/eos/build/programs/daemon/data-dir</div><div class="line">#      wallet directory: /mnt/e/Workspaces/EOS/eos/build/programs/daemon/data-dir/wallet</div><div class="line">#     head block number: 2</div><div class="line">#       head block time: 2018-04-10T17:20:54</div><div class="line"></div><div class="line"># See a prove that the daemon is started:</div><div class="line">print(daemon)</div><div class="line">#            head block: 1047</div><div class="line">#       head block time: 2018-04-10T16:57:27</div><div class="line">#  last irreversible block: 1046</div></div><!-- fragment --> <h3>Create a wallet</h3>
<p>Every contract requires an associated account, so first you need to create a wallet. To create a wallet, you need to have the wallet_api_plugin loaded into the nodeos process: </p><div class="fragment"><div class="line">wallet = teos.Wallet()</div></div><!-- fragment --><p> The wallet name argument is not set: the default wallet name is 'default'.</p>
<h3>Load the Bios Contract</h3>
<p>You have to owe an account to be authorized to interact with EOSIO. For tests, you can use the 'eosio' account: </p><div class="fragment"><div class="line">account_eosio = teos.EosioAccount()</div></div><!-- fragment --><p> Set a smart contract defined in folder eos-source-dir/build/contracts/eosio.bios/ as the default system contract. This contract enables you to have direct control over the resource allocation of other accounts and to access other privileged API calls. </p><div class="fragment"><div class="line">contract_eosio_bios = teos.SetContract(</div><div class="line">  account_eosio, &quot;eosio.bios&quot;, permission=account_eosio)</div><div class="line">#        transaction id: 7d5d9c7f56d46d6eab95f2dea6aaab667b5eb3d087737ada0cba5b82f26962c3</div></div><!-- fragment --><p> The second argument in the constructor indicates a directory that contains the contract files. The path to this directory is determined with <a href="#setup">setup rules</a>. An absolute path is an option.</p>
<p>As the set contract command call has produced the transaction id, the default contract is operational.</p>
<h3>Create an account for the "currency" contract</h3>
<p>The account named "currency" will be used for the "currency" contract. Generate two public/private key pairs that will be later assigned as the key_owner and the key_active: </p><div class="fragment"><div class="line">key_owner = teos.CreateKey(&quot;key_owner&quot;)</div><div class="line">#              key name: key_owner</div><div class="line">#           private key: 5J4bSiNprJzPYVHqoZdSDGTTd454LiDc89AVvKT4Miv2SyzZTDF</div><div class="line">#            public key: EOS7vDtGf9cVxEChKN7YeDgqMGrgFgvcCdN5qAUEhMMufAnPHddTb</div><div class="line">key_active = teos.CreateKey(&quot;key_active&quot;)</div><div class="line">#              key name: key_active</div><div class="line">#           private key: 5KRHeQ1S7pEtCw6TMeW6WKvupuR8cVGJjpNbAN5uviXTAtvhmDW</div><div class="line">#            public key: EOS6FfNuYYKoSa7pjhoqqeymi6iwe6j9ukVHiQxPbMeAcHmcoxRwj</div></div><!-- fragment --><p> Import the two private keys into the wallet:</p>
<p>wallet.import_key(key_owner) wallet.import_key(key_active)</p>
<p>You can see the contents of the wallet: </p><div class="fragment"><div class="line">print(wallet)</div><div class="line">{&#39;keys&#39;: [[&#39;key_owner&#39;, &#39;5J4bSiNprJzPYVHqoZdSDGTTd454LiDc89AVvKT4Miv2SyzZTDF&#39;],</div><div class="line">          [&#39;key_active&#39;,</div><div class="line">           &#39;5KRHeQ1S7pEtCw6TMeW6WKvupuR8cVGJjpNbAN5uviXTAtvhmDW&#39;]],</div><div class="line"> &#39;name&#39;: &#39;default&#39;,</div><div class="line"> &#39;password&#39;: &#39;PW5Kih88UxyFeVeYfWiuhbBRVhxmzr4nVvyTjsuNLgP6Ropxb9SJY&#39;}</div></div><!-- fragment --><p> Create the currency account. The creation will be authorized by the eosio account. The two public keys generated above will be associated with the account, one as its owner key and the other as its active key. </p><div class="fragment"><div class="line">account_currency = teos.Account(account_eosio, &quot;currency&quot;, key_owner, key_active)</div><div class="line">#        transaction id: 0c4e0fb1163562909a83947b77aa3ee293b880cd61d4c6610fdcd3198e2d0eb7</div></div><!-- fragment --><p> As the first argument is the authorizing account (or the name of this acconut), the second argument specifies the name of the creation.</p>
<p>As the account command call has produced the transaction id, the account is walid. You can see its description: </p><div class="fragment"><div class="line">print(account_currency)</div><div class="line">{&#39;account_name&#39;: &#39;currency&#39;,</div><div class="line"> &#39;permissions&#39;: [{&#39;parent&#39;: &#39;owner&#39;,</div><div class="line">                  &#39;perm_name&#39;: &#39;active&#39;,</div><div class="line">                  &#39;required_auth&#39;: {&#39;accounts&#39;: &#39;&#39;,</div><div class="line">                                    &#39;keys&#39;: [{&#39;key&#39;: &#39;EOS88rqdDApfzRMcSCTuy3HmS2gBZSW8ZokjC8cQ4aeFL7zEQqmdx&#39;,</div><div class="line">                                              &#39;weight&#39;: &#39;1&#39;}],</div><div class="line">                                    &#39;threshold&#39;: &#39;1&#39;}},</div><div class="line">                 {&#39;parent&#39;: &#39;&#39;,</div><div class="line">                  &#39;perm_name&#39;: &#39;owner&#39;,</div><div class="line">                  &#39;required_auth&#39;: {&#39;accounts&#39;: &#39;&#39;,</div><div class="line">                                    &#39;keys&#39;: [{&#39;key&#39;: &#39;EOS5WULc9uFcaME5xJbHdrrbi5xr3AhCNCogaeMGoxRkPp8PATmtc&#39;,</div><div class="line">                                              &#39;weight&#39;: &#39;1&#39;}],</div><div class="line">                                    &#39;threshold&#39;: &#39;1&#39;}}]}</div></div><!-- fragment --> <h3>Upload the sample "currency" contract to the blockchain</h3>
<p>Before uploading a contract, verify that there is no current contract: </p><div class="fragment"><div class="line">print(account_currency.code())</div><div class="line">#             code hash: 0000000000000000000000000000000000000000000000000000000000000000</div></div><!-- fragment --><p> Upload the currency contract using an authorization of the currency account: </p><div class="fragment"><div class="line">contract_currency = teos.Contract(account_currency, &quot;currency&quot;)</div><div class="line">print(contract_currency)</div><div class="line">#        transaction id: 9c1b663cafcbe7ffbb18527fecfa7aa58237d00e02af125eed19b7021388238e</div></div><!-- fragment --><p> Printout is a valid transaction id.</p>
<p>You can also verify that the code has been set: </p><div class="fragment"><div class="line">print(account_currency.code())</div><div class="line">#             code hash: d6c891fbdfcff597d82e17c81354574399b01d533e53d412093f03e1950fb9d4</div></div><!-- fragment --><p> Before using the currency contract, you must first create it: </p><div class="fragment"><div class="line">contract_currency.action(</div><div class="line">  &quot;create&quot;, </div><div class="line">  &#39;{&quot;issuer&quot;:&quot;currency&quot;,&quot;maximum_supply&quot;:&quot;1000000.0000 CUR&quot;, \</div><div class="line">  &quot;can_freeze&quot;:&quot;0&quot;,&quot;can_recall&quot;:&quot;0&quot;,&quot;can_whitelist&quot;:&quot;0&quot;}&#39;)</div><div class="line">#        transaction id: afe3ed99759c637b39244556bbf14d3d49260efd37c165fb8bd1ec3c6faf6fbf</div></div><!-- fragment --><p> Now, you can issue the currency: </p><div class="fragment"><div class="line">contract_currency.action(</div><div class="line">  &quot;issue&quot;, </div><div class="line">  &#39;{&quot;to&quot;:&quot;currency&quot;,&quot;quantity&quot;:&quot;1000.0000 CUR&quot;,&quot;memo&quot;:&quot;&quot;}&#39;)</div><div class="line">#        transaction id: fd37c165fb8bd1ec3c6faf6fbfafe3ed99759c637b39244556bbf14d3d49260e</div></div><!-- fragment --><p> Verify the currency contract has the proper initial balance: </p><div class="fragment"><div class="line">account_currency.accounts()</div></div><!-- fragment --> <h3>Transfer funds using the "currency" contract</h3>
<p>The following command shows a "transfer" action being sent to the currency contract, transferring "20.0000 CUR" from the currency account to the "eosio" account. </p><div class="fragment"><div class="line">contract_currency.action(</div><div class="line">  &quot;transfer&quot;,</div><div class="line">  &#39;{&quot;from&quot;:&quot;currency&quot;,&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;20.0000 CUR&quot;, \</div><div class="line">    &quot;memo&quot;:&quot;my first transfer&quot;}&#39;</div><div class="line">)</div></div><!-- fragment --><p> A successfully submitted transaction has generated a transaction ID.</p>
<h3>Check the "currency" contract balances</h3>
<p>Check the state of both accounts involved in the previous transaction: </p><div class="fragment"><div class="line">account_currency.accounts(account_currency)</div><div class="line">#  {</div><div class="line">#      &quot;rows&quot;: [</div><div class="line">#          {</div><div class="line">#              &quot;balance&quot;: &quot;980.0000 CUR&quot;,</div><div class="line">#              &quot;frozen&quot;: &quot;0&quot;,</div><div class="line">#              &quot;whitelist&quot;: &quot;1&quot;</div><div class="line">#          }</div><div class="line">#      ],</div><div class="line">#      &quot;more&quot;: &quot;false&quot;</div><div class="line">#  }</div><div class="line">#</div><div class="line"></div><div class="line">account_eosio.accounts(account_currency)</div><div class="line">#  {</div><div class="line">#      &quot;rows&quot;: [</div><div class="line">#          {</div><div class="line">#              &quot;balance&quot;: &quot;20.0000 CUR&quot;,</div><div class="line">#              &quot;frozen&quot;: &quot;0&quot;,</div><div class="line">#              &quot;whitelist&quot;: &quot;1&quot;</div><div class="line">#          }</div><div class="line">#      ],</div><div class="line">#      &quot;more&quot;: &quot;false&quot;</div><div class="line">#  }</div><div class="line">#</div></div><!-- fragment --><div class="fragment"><div class="line">daemon = teos.Daemon()</div><div class="line">daemon.clear()</div><div class="line">print(daemon)</div><div class="line">wallet = teos.Wallet()</div><div class="line">account_eosio = teos.EosioAccount()</div><div class="line">contract_eosio_bios = teos.SetContract(</div><div class="line">    account_eosio, &quot;eosio.bios&quot;, permission=account_eosio)</div><div class="line">key_owner = teos.CreateKey(&quot;key_owner&quot;)</div><div class="line">key_active = teos.CreateKey(&quot;key_active&quot;)</div><div class="line">wallet.import_key(key_owner)</div><div class="line">wallet.import_key(key_active)</div><div class="line">account_currency = teos.Account(</div><div class="line">    account_eosio, &quot;currency&quot;, key_owner, key_active)</div><div class="line">print(account_currency)</div><div class="line">print(account_currency.code())</div><div class="line">contract_currency = teos.Contract(account_currency, &quot;currency&quot;)</div><div class="line">print(contract_currency)</div><div class="line">print(account_currency.code())</div><div class="line">contract_currency.action(</div><div class="line">  &quot;create&quot;, </div><div class="line">  &#39;{&quot;issuer&quot;:&quot;currency&quot;,&quot;maximum_supply&quot;:&quot;1000000.0000 CUR&quot;, \</div><div class="line">  &quot;can_freeze&quot;:&quot;0&quot;,&quot;can_recall&quot;:&quot;0&quot;,&quot;can_whitelist&quot;:&quot;0&quot;}&#39;)</div><div class="line">contract_currency.action(</div><div class="line">  &quot;issue&quot;, </div><div class="line">  &#39;{&quot;to&quot;:&quot;currency&quot;,&quot;quantity&quot;:&quot;1000.0000 CUR&quot;,&quot;memo&quot;:&quot;&quot;}&#39;)</div><div class="line">account_currency.accounts()</div><div class="line">contract_currency.action(</div><div class="line">  &quot;transfer&quot;,</div><div class="line">  &#39;{&quot;from&quot;:&quot;currency&quot;,&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;20.0000 CUR&quot;, \</div><div class="line">    &quot;memo&quot;:&quot;my first transfer&quot;}&#39;</div><div class="line">)</div><div class="line">account_currency.accounts(account_currency)</div><div class="line">account_eosio.accounts(account_currency)</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
