
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Interacting with Public Testnet &#8212; EOSFactory 2.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">EOSFactory 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="interacting-with-public-testnet">
<span id="interacting-with-public-testnet"></span><h1>Interacting with Public Testnet<a class="headerlink" href="#interacting-with-public-testnet" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this tutorial is to demonstrate how EOSFactory can be used to deploy and test EOS smart-contracts on a public testnet, e.g. <a class="reference external" href="http://dev.remote_testnet.io">Jungle Testnet</a>.</p>
<div class="section" id="prerequisites">
<span id="prerequisites"></span><h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">This tutorial assumes that you have successfully installed EOSFactory. If it’s not the case, please refer to <a class="reference external" href="01.InstallingEOSFactory.html">Installing EOSFactory</a>.</p>
</li>
<li><p class="first">We assume that you are familiar with the material covered in <a class="reference external" href="02.InteractingWithEOSContractsInEOSFactory.html">Interacting with EOS Contracts in EOSFactory</a> and <a class="reference external" href="03.BuildingAndDeployingEOSContractsInEOSFactory.html">Building &amp; Deploying EOS Contracts using EOSFactory</a>.</p>
</li>
<li><p class="first">We also assume you have <a class="reference external" href="https://code.visualstudio.com/">Visual Studio Code</a> installed. If you are on Windows and run VSC for the first time, in order to get access to <em>Windows Subsystem for Linux</em> bash terminal inside VSC, navigate to <code class="docutils literal notranslate"><span class="pre">Preferences</span> <span class="pre">-&gt;</span> <span class="pre">Settings</span></code> and overwrite the default configuration for the <code class="docutils literal notranslate"><span class="pre">terminal.integrated.shell.windows</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="s2">&quot;terminal.integrated.shell.windows&quot;</span><span class="p">:</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Windows</span><span class="se">\\</span><span class="s2">sysnative</span><span class="se">\\</span><span class="s2">bash.exe&quot;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="the-problems-with-public-testnet">
<span id="the-problems-with-public-testnet"></span><h2>The problems with public testnet<a class="headerlink" href="#the-problems-with-public-testnet" title="Permalink to this headline">¶</a></h2>
<p>To be able to create a new account on a public testnet you need an account name and two public keys (owner &amp; active). The problem with account names is that they need to be unique and also comply with strict rules (e.g. <code class="docutils literal notranslate"><span class="pre">[a-z1-5]{12}</span></code> ).</p>
<p>Another problem is that you do not have full control of a public testnet (as is the case with a local private testnet), you cannot reset it any time you want and thus each time you use a public testnet for your smart-contract testing you need to either create a new set of accounts (which is ineffective and time consuming) or you need to carefully recycle the same set of accounts (each having a unique random name).</p>
<p>EOSFactory uses the latter approach and offers a built-in mechanism for mapping random account names to fixed names used in smart-contract testing. The mapping is stored in this location: <code class="docutils literal notranslate"><span class="pre">~/eosio-wallet/accounts.json</span></code>.</p>
<p>Because of the above complexity we recommend sticking very strictly to the following procedure.</p>
</div>
<div class="section" id="create-a-new-account-on-a-public-testnet">
<span id="create-a-new-account-on-a-public-testnet"></span><h2>Create a new account on a public testnet<a class="headerlink" href="#create-a-new-account-on-a-public-testnet" title="Permalink to this headline">¶</a></h2>
<p>Open a bash terminal and run Python CLI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">python3</span>
</pre></div>
</div>
<p>The prompt should change to <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> signifying that it’s ready for Python commands.</p>
<p>Then run the following set of commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">setup</span><span class="o">,</span> <span class="nn">eosf</span>
<span class="n">setup</span><span class="o">.</span><span class="n">set_nodeos_address</span><span class="p">(</span><span class="s2">&quot;88.99.97.30:38888&quot;</span><span class="p">)</span>
<span class="n">eosf</span><span class="o">.</span><span class="n">kill_keosd</span><span class="p">()</span>
<span class="n">eosf</span><span class="o">.</span><span class="n">clear_account_mapp</span><span class="p">([])</span>
<span class="n">wallet</span> <span class="o">=</span> <span class="n">eosf</span><span class="o">.</span><span class="n">Wallet</span><span class="p">(</span><span class="s2">&quot;jungle_wallet&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> The <code class="docutils literal notranslate"><span class="pre">88.99.97.30:38888</span></code> URL is a <a class="reference external" href="https://remote_testnet.io/">CryptoLions</a> endpoint to the <a class="reference external" href="http://dev.remote_testnet.io/">Jungle Testnet</a>. For public testnet we need to rely on the <code class="docutils literal notranslate"><span class="pre">keosd</span></code> toolset for wallet management, which means that your wallet will be stored in the <code class="docutils literal notranslate"><span class="pre">~/eosio-wallet</span></code> folder. The name <code class="docutils literal notranslate"><span class="pre">jungle_wallet</span></code> can be replaced by any name you prefer - just make sure there is no naming conflict with any an existing wallet.</p>
<p>This is the outcome you should get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre>Created wallet `jungle_wallet` with the `keosd` Wallet Manager.
Save password to use in the future to unlock this wallet.
Without password imported keys will not be retrievable.
PW5KDRWrMAev57rfJ8z9FXpRA1tEG4EJ6nsnpVAfYdHRe5WDMnnLz
</pre></div>
</div>
<p><strong>NOTE:</strong> Your wallet password will obviously be different. Please store it in a secure place, as it will be needed in the subsequent step.</p>
<p>Next run this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">account_master</span> <span class="o">=</span> <span class="n">eosf</span><span class="o">.</span><span class="n">AccountMaster</span><span class="p">()</span>
</pre></div>
</div>
<p>Note the response containing the proposed values for the name of your primary testnet account and two public keys (owner and active):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">Use</span> <span class="n">the</span> <span class="n">following</span> <span class="n">data</span> <span class="n">to</span> <span class="n">register</span> <span class="n">a</span> <span class="n">new</span> <span class="n">account</span> <span class="n">on</span> <span class="n">a</span> <span class="n">public</span> <span class="n">testnet</span><span class="p">:</span>
<span class="n">Accout</span> <span class="n">Name</span><span class="p">:</span> <span class="n">zk3lmwma5fpb</span>
<span class="n">Owner</span> <span class="n">Public</span> <span class="n">Key</span><span class="p">:</span> <span class="n">EOS7MaUxbed3qVyFdh1xPDDEp8NygyFt2tNdMRs5JroPGWLfqJJej</span>
<span class="n">Owner</span> <span class="n">Private</span> <span class="n">Key</span><span class="p">:</span> <span class="mi">5</span><span class="n">JKMCuGQySyFaCUKorwoiKW1MHRFf1qH4daCo2Lmn36V8fBSF2D</span>
<span class="n">Active</span> <span class="n">Public</span> <span class="n">Key</span><span class="p">:</span> <span class="n">EOS7VmjcvCysaCBAPXy9UxSGtgsAEi79wd9cS4VrUN6iWGRemarE2</span>
<span class="n">Active</span> <span class="n">Private</span> <span class="n">Key</span><span class="p">:</span> <span class="mi">5</span><span class="n">KU4eMGPSw8z9UJfTc5pRBhkkXNEdVpKAQd9sCbeEFdVdXhBHAH</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> As both the account name and it keys are generated randomly (to ensure their uniqueness on a public testnet) the above values will obviously be different each time you run the command.</p>
<p>Next, open the <a class="reference external" href="http://dev.remote_testnet.io/">Jungle Testnet monitor</a> in your web browser and create a new account there (select the <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">Account</span></code> menu option) using the above data for account name, owner public key and active public key. Then use the testnet faucet (select the <code class="docutils literal notranslate"><span class="pre">Faucet</span></code> menu option) to send some funds into the newly created account.</p>
<p>Next, navigate back to your Python terminal and run these commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">wallet</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">account_master</span><span class="p">)</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">restore_accounts</span><span class="p">(</span><span class="nb">globals</span><span class="p">())</span>
</pre></div>
</div>
<p>The outcome should look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">Restored</span> <span class="n">accounts</span> <span class="k">as</span> <span class="k">global</span> <span class="n">variables</span><span class="p">:</span>
<span class="n">account_master</span> <span class="p">(</span><span class="n">zk3lmwma5fpb</span><span class="p">)</span>
</pre></div>
</div>
<p>What is happening here is the following: EOSFactory verifies that the given account exists on the public testnet and associates its random name (in this case <code class="docutils literal notranslate"><span class="pre">zk3lmwma5fpb</span></code>) with a variable name (in this case <code class="docutils literal notranslate"><span class="pre">account_master</span></code>).</p>
</div>
<div class="section" id="build-the-smart-contract">
<span id="build-the-smart-contract"></span><h2>Build the smart-contract<a class="headerlink" href="#build-the-smart-contract" title="Permalink to this headline">¶</a></h2>
<p>Open the <code class="docutils literal notranslate"><span class="pre">eosfactory/contracts/tic_tac_toe_jungle</span></code> folder in VS Code.</p>
<p>First, modify line <code class="docutils literal notranslate"><span class="pre">47</span></code> inside  <code class="docutils literal notranslate"><span class="pre">src/tic_tac_toe.hpp</span></code> so that instead of the original <code class="docutils literal notranslate"><span class="pre">tic.tac.toe</span></code> account name it contains the name of the account you created on the testnet in the previous step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">static</span> <span class="n">const</span> <span class="n">account_name</span> <span class="n">code_account</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="o">&lt;</span><span class="n">your</span> <span class="n">account</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">static</span> <span class="n">const</span> <span class="n">account_name</span> <span class="n">code_account</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">zk3lmwma5fpb</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> This is needed as the <code class="docutils literal notranslate"><span class="pre">tic_tac_toe</span></code> smart-contract example is bound to a specific account name defined in the header file. You cannot use the default account name <code class="docutils literal notranslate"><span class="pre">tic.tac.toe</span></code>, as it cannot be created on a public testnet, so you need to replace it with your own name.</p>
<p>Make sure you save the file after being modified.</p>
<p>Next, navigate to the <code class="docutils literal notranslate"><span class="pre">tic_tac_toe_jungle/build</span></code> folder and run <em>CMake</em> to build the contract:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">cmake</span> <span class="o">..</span>
</pre></div>
</div>
<p>And then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">make</span>
</pre></div>
</div>
</div>
<div class="section" id="prepare-unit-tests">
<span id="prepare-unit-tests"></span><h2>Prepare unit tests<a class="headerlink" href="#prepare-unit-tests" title="Permalink to this headline">¶</a></h2>
<p>Edit the <code class="docutils literal notranslate"><span class="pre">test/unittest1.py</span></code> file and in lines <code class="docutils literal notranslate"><span class="pre">7</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">8</span></code> enter the name and password of the wallet created in the first step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">wallet_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;your wallet name&gt;&quot;</span>
<span class="n">wallet_pass</span> <span class="o">=</span> <span class="s2">&quot;&lt;your wallet password&gt;&quot;</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">wallet_name</span> <span class="o">=</span> <span class="s2">&quot;jungle_wallet&quot;</span>
<span class="n">wallet_pass</span> <span class="o">=</span> <span class="s2">&quot;PW5KDRWrMAev57rfJ8z9FXpRA1tEG4EJ6nsnpVAfYdHRe5WDMnnLz&quot;</span>
</pre></div>
</div>
<p>Perform similar amendments in the the <code class="docutils literal notranslate"><span class="pre">test/test1.py</span></code> file and make sure both files are saved after being modified.</p>
</div>
<div class="section" id="run-unit-tests">
<span id="run-unit-tests"></span><h2>Run unit tests<a class="headerlink" href="#run-unit-tests" title="Permalink to this headline">¶</a></h2>
<p>Finally, open a bash terminal, navigate to the <code class="docutils literal notranslate"><span class="pre">tic_tac_toe_jungle/test</span></code> folder and execute the content of the <code class="docutils literal notranslate"><span class="pre">unittest1.py</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">python3</span> <span class="n">unittest1</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This is what the final outcome should look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">Ran</span> <span class="mi">1</span> <span class="n">test</span> <span class="ow">in</span> <span class="mf">2.223</span><span class="n">s</span>
<span class="n">OK</span>
</pre></div>
</div>
<p>Please note that line <code class="docutils literal notranslate"><span class="pre">9</span></code> of the <code class="docutils literal notranslate"><span class="pre">unittest1.py</span></code> file (as well as line <code class="docutils literal notranslate"><span class="pre">7</span></code> of the <code class="docutils literal notranslate"><span class="pre">test1.py</span></code> file) contains an important flag which determines whether contract deployment is included in the unit test setup phase:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">deployment</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>In EOS contract deployment for a given account is allowed only once (unless the source code is changed and the contract is re-built). Therefore for a subsequent run remember to change this flag to <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">deployment</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Otherwise you’ll get this error when trying to re-run the test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="n">contract</span><span class="o">.</span><span class="n">deploy</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, please note that during the initial run two additional accounts are created on the testnet. Their names are random (to ensure their uniqueness) but in the code they are referred to as <code class="docutils literal notranslate"><span class="pre">account_alice</span></code>  and <code class="docutils literal notranslate"><span class="pre">account_carol</span></code>. During subsequent runs those two accounts are re-used.</p>
<p>You might also want to run the other (non-standard) test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">python3</span> <span class="n">test1</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> If you’ve already run <code class="docutils literal notranslate"><span class="pre">unittest1.py</span></code> prior to that, please remember to set the deployment flag to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
<div class="section" id="run-unit-tests-using-cmake">
<span id="run-unit-tests-using-cmake"></span><h2>Run unit tests using <em>CMake</em><a class="headerlink" href="#run-unit-tests-using-cmake" title="Permalink to this headline">¶</a></h2>
<p>You can also run both tests using the <em>CMake</em> utility.</p>
<p>To do that navigate to the <code class="docutils literal notranslate"><span class="pre">tic_tac_toe_jungle/build</span></code> folder and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">ctest</span>
</pre></div>
</div>
<p>This is the expected outcome:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">Test</span> <span class="n">project</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">d</span><span class="o">/</span><span class="n">Workspaces</span><span class="o">/</span><span class="n">EOS</span><span class="o">/</span><span class="n">eosfactory</span><span class="o">/</span><span class="n">contracts</span><span class="o">/</span><span class="n">tic_tac_toe_jungle</span><span class="o">/</span><span class="n">build</span>
    <span class="n">Start</span> <span class="mi">1</span><span class="p">:</span> <span class="n">test</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="n">Test</span> <span class="c1">#1: test .............................   Passed    2.73 sec</span>
    <span class="n">Start</span> <span class="mi">2</span><span class="p">:</span> <span class="n">unittest</span>
<span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="n">Test</span> <span class="c1">#2: unittest .........................   Passed    5.51 sec</span>

<span class="mi">100</span><span class="o">%</span> <span class="n">tests</span> <span class="n">passed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">tests</span> <span class="n">failed</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">2</span>

<span class="n">Total</span> <span class="n">Test</span> <span class="n">time</span> <span class="p">(</span><span class="n">real</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">8.25</span> <span class="n">sec</span>
</pre></div>
</div>
<p>If you prefer more verbosity, use the <code class="docutils literal notranslate"><span class="pre">-V</span></code> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">ctest</span> <span class="o">-</span><span class="n">V</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Interacting with Public Testnet</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#the-problems-with-public-testnet">The problems with public testnet</a></li>
<li><a class="reference internal" href="#create-a-new-account-on-a-public-testnet">Create a new account on a public testnet</a></li>
<li><a class="reference internal" href="#build-the-smart-contract">Build the smart-contract</a></li>
<li><a class="reference internal" href="#prepare-unit-tests">Prepare unit tests</a></li>
<li><a class="reference internal" href="#run-unit-tests">Run unit tests</a></li>
<li><a class="reference internal" href="#run-unit-tests-using-cmake">Run unit tests using <em>CMake</em></a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorials/05.InteractingWithPublicTestnet.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">EOSFactory 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Tokenika.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>