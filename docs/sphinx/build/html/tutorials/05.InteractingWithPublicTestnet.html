<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Interacting with Public Testnet &#8212; EOSFactory 0.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plan for Subsequent EOSFactory Releases" href="../roadmap/PlanForSubsequentEOSFactoryReleases.html" />
    <link rel="prev" title="Working with EOS Contracts using EOSFactory in Visual Studio Code" href="04.WorkingWithEOSContractsUsingEOSFactoryInVSC.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          EOSFactory</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../releases/ReleaseNotesVersion0.8.html">EOSFactory Release Notes - v0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/ReleaseNotesVersion1.0.html">EOSFactory Release Notes - v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/ReleaseNotesVersion1.1.html">EOSFactory Release Notes - v1.1</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="00.IntroductionToEOSFactory.html">Introduction to EOSFactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="01.InstallingEOSFactory.html">Installing EOSFactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="02.InteractingWithEOSContractsInEOSFactory.html">Interacting with EOS Contracts in EOSFactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="03.BuildingAndDeployingEOSContractsInEOSFactory.html">Building and Deploying EOS Contracts using EOSFactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.WorkingWithEOSContractsUsingEOSFactoryInVSC.html">Working with EOS Contracts using EOSFactory in <em>Visual Studio Code</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Interacting with Public Testnet</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/PlanForSubsequentEOSFactoryReleases.html">Plan for Subsequent EOSFactory Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/LongTermEOSFactoryRoadmap.html">Long-term EOSFactory Roadmap</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pyteos.html">pyteos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eosf.html">eosf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../node.html">node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sess.html">sess</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Interacting with Public Testnet</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#the-problems-with-public-testnet">The problems with public testnet</a></li>
<li><a class="reference internal" href="#create-a-new-account-on-a-public-testnet">Create a new account on a public testnet</a></li>
<li><a class="reference internal" href="#build-the-smart-contract">Build the smart-contract</a></li>
<li><a class="reference internal" href="#prepare-the-unit-test">Prepare the unit test</a></li>
<li><a class="reference internal" href="#run-the-unit-test">Run the unit test</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="04.WorkingWithEOSContractsUsingEOSFactoryInVSC.html" title="Previous Chapter: Working with EOS Contracts using EOSFactory in Visual Studio Code"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Working with ...</span>
    </a>
  </li>
  <li>
    <a href="../roadmap/PlanForSubsequentEOSFactoryReleases.html" title="Next Chapter: Plan for Subsequent EOSFactory Releases"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Plan for Subs... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/tutorials/05.InteractingWithPublicTestnet.md.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="interacting-with-public-testnet">
<span id="interacting-with-public-testnet"></span><h1>Interacting with Public Testnet<a class="headerlink" href="#interacting-with-public-testnet" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this tutorial is to demonstrate how EOSFactory can be used to deploy and test EOS smart-contracts on a public testnet, e.g. <a class="reference external" href="http://dev.cryptolions.io">Jungle</a>.</p>
<div class="section" id="prerequisites">
<span id="prerequisites"></span><h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">This tutorial assumes that you have successfully installed EOSFactory. If it’s not the case, please refer to <a class="reference external" href="01.InstallingEOSFactory.html">Installing EOSFactory</a>.</p>
</li>
<li><p class="first">We assume that you are familiar with the material covered in <a class="reference external" href="02.InteractingWithEOSContractsInEOSFactory.html">Interacting with EOS Contracts in EOSFactory</a> and <a class="reference external" href="03.BuildingAndDeployingEOSContractsInEOSFactory.md">Building &amp; Deploying EOS Contracts using EOSFactory</a>.</p>
</li>
<li><p class="first">We also assume you have <a class="reference external" href="https://code.visualstudio.com/">Visual Studio Code</a> installed. If you are on Windows and run VSC for the first time, in order to get access to <em>Windows Subsystem for Linux</em> bash terminal inside VSC, navigate to <code class="docutils literal"><span class="pre">Preferences</span> <span class="pre">-&gt;</span> <span class="pre">Settings</span></code> and overwrite the default configuration for the <code class="docutils literal"><span class="pre">terminal.integrated.shell.windows</span></code> option:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;terminal.integrated.shell.windows&quot;</span><span class="p">:</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Windows</span><span class="se">\\</span><span class="s2">sysnative</span><span class="se">\\</span><span class="s2">bash.exe&quot;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="the-problems-with-public-testnet">
<span id="the-problems-with-public-testnet"></span><h2>The problems with public testnet<a class="headerlink" href="#the-problems-with-public-testnet" title="Permalink to this headline">¶</a></h2>
<p>To be able to create a new account on a public testnet you need an account name and two public keys (owner &amp; active). The problem with account names is that they need to be unique and also comply with strict rules (e.g. <code class="docutils literal"><span class="pre">[a-z1-5]{12}</span></code> ).</p>
<p>Another problem is that you do not have full control of a public testnet (as is the case with a local private testnet) and you cannot reset it and thus each time you use a public testnet for your smart-contract testing you need to either create a new set of accounts (which is ineffective and time consuming) or you need to carefully recycle the same set of accounts (each having a unique random name).</p>
<p>EOSFactory uses the latter approach and offers a built-in mechanism for mapping random account names to fixed names used in smart-contract testing. The mapping is stored in this location: <code class="docutils literal"><span class="pre">~/eosio-wallet/accounts.json</span></code>.</p>
<p>And this what account mapping looks like in action:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Restored</span> <span class="n">accounts</span> <span class="k">as</span> <span class="k">global</span> <span class="n">variables</span><span class="p">:</span>
<span class="n">account_master</span> <span class="p">(</span><span class="n">zk3lmwma5fpb</span><span class="p">)</span>
<span class="n">account_alice</span> <span class="p">(</span><span class="n">w3qdegfsbago</span><span class="p">)</span>
<span class="n">account_carol</span> <span class="p">(</span><span class="n">dp4wrcuy3f5v</span><span class="p">)</span>
</pre></div>
</div>
<p>Because of the above complexity we recommend sticking very strictly to the following procedure.</p>
</div>
<div class="section" id="create-a-new-account-on-a-public-testnet">
<span id="create-a-new-account-on-a-public-testnet"></span><h2>Create a new account on a public testnet<a class="headerlink" href="#create-a-new-account-on-a-public-testnet" title="Permalink to this headline">¶</a></h2>
<p>Open a bash terminal and run Python CLI:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python3</span>
</pre></div>
</div>
<p>The prompt should change to <code class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></code> signifying that it’s ready for Python commands.</p>
<p>Then run the following set of commands.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">setup</span><span class="o">,</span> <span class="nn">eosf</span>
<span class="n">setup</span><span class="o">.</span><span class="n">use_keosd</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">setup</span><span class="o">.</span><span class="n">set_nodeos_URL</span><span class="p">(</span><span class="s2">&quot;88.99.97.30:38888&quot;</span><span class="p">)</span>
<span class="n">wallet</span> <span class="o">=</span> <span class="n">eosf</span><span class="o">.</span><span class="n">Wallet</span><span class="p">(</span><span class="s2">&quot;jungle_wallet&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> The <code class="docutils literal"><span class="pre">88.99.97.30:38888</span></code> URL is a Cryptolions endpoint to the <a class="reference external" href="http://dev.cryptolions.io/">Jungle Testnet</a>. For public testnet we need to rely on the <code class="docutils literal"><span class="pre">keosd</span></code> toolset for wallet management, which means that your wallet will be stored in the <code class="docutils literal"><span class="pre">~/eosio-wallet</span></code> folder. The name <code class="docutils literal"><span class="pre">jungle_wallet</span></code> can be replaced by any name you prefer - just make sure there is no naming conflict with any an existing wallet.</p>
<p>This is the outcome you should get:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Creating</span> <span class="n">wallet</span><span class="p">:</span> <span class="n">jungle_wallet</span>
<span class="n">Save</span> <span class="n">password</span> <span class="n">to</span> <span class="n">use</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">future</span> <span class="n">to</span> <span class="n">unlock</span> <span class="n">this</span> <span class="n">wallet</span><span class="o">.</span>
<span class="n">Without</span> <span class="n">password</span> <span class="n">imported</span> <span class="n">keys</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">retrievable</span><span class="o">.</span>
<span class="s2">&quot;PW5KDRWrMAev57rfJ8z9FXpRA1tEG4EJ6nsnpVAfYdHRe5WDMnnLz&quot;</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> Your wallet password will obviously be different. Please store it in a secure place, as it will be needed in the subsequent step.</p>
<p>Next run this command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">account_master</span> <span class="o">=</span> <span class="n">eosf</span><span class="o">.</span><span class="n">AccountMaster</span><span class="p">()</span>
</pre></div>
</div>
<p>Note the response containing the proposed values for the name of your primary testnet account and two public keys (owner and active):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Use</span> <span class="n">the</span> <span class="n">following</span> <span class="n">data</span> <span class="n">to</span> <span class="n">register</span> <span class="n">a</span> <span class="n">new</span> <span class="n">account</span> <span class="n">on</span> <span class="n">a</span> <span class="n">public</span> <span class="n">testnet</span><span class="p">:</span>
<span class="n">Accout</span> <span class="n">Name</span><span class="p">:</span> <span class="n">zk3lmwma5fpb</span>
<span class="n">Owner</span> <span class="n">Public</span> <span class="n">Key</span><span class="p">:</span> <span class="n">EOS7MaUxbed3qVyFdh1xPDDEp8NygyFt2tNdMRs5JroPGWLfqJJej</span>
<span class="n">Owner</span> <span class="n">Private</span> <span class="n">Key</span><span class="p">:</span> <span class="mi">5</span><span class="n">JKMCuGQySyFaCUKorwoiKW1MHRFf1qH4daCo2Lmn36V8fBSF2D</span>
<span class="n">Active</span> <span class="n">Public</span> <span class="n">Key</span><span class="p">:</span> <span class="n">EOS7VmjcvCysaCBAPXy9UxSGtgsAEi79wd9cS4VrUN6iWGRemarE2</span>
<span class="n">Active</span> <span class="n">Private</span> <span class="n">Key</span><span class="p">:</span> <span class="mi">5</span><span class="n">KU4eMGPSw8z9UJfTc5pRBhkkXNEdVpKAQd9sCbeEFdVdXhBHAH</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> As both the account name and it keys are generated randomly (to ensure their uniqueness on a public testnet) the above values will obviously be different each time you run the command.</p>
<p>Next, open the <a class="reference external" href="http://dev.cryptolions.io/">Jungle Testnet monitor</a> in your web browser and create a new account there (select the <code class="docutils literal"><span class="pre">Create</span> <span class="pre">Account</span></code> menu option) using the above data for account name, owner public key and active public key. Then use the testnet faucet (select the <code class="docutils literal"><span class="pre">Faucet</span></code> menu option) to send some funds into the newly created account.</p>
<p>Next, navigate back to your Python terminal and run these two commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">wallet</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">account_master</span><span class="p">)</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">restore_accounts</span><span class="p">(</span><span class="nb">globals</span><span class="p">())</span>
</pre></div>
</div>
<p>The outcome should look like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">&#39;account_master&#39;</span> <span class="p">(</span><span class="n">zk3lmwma5fpb</span><span class="p">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;~/eosio-wallet/accounts.json&#39;</span>
<span class="n">Restored</span> <span class="n">accounts</span> <span class="k">as</span> <span class="k">global</span> <span class="n">variables</span><span class="p">:</span>
<span class="n">account_master</span> <span class="p">(</span><span class="n">zk3lmwma5fpb</span><span class="p">)</span>
</pre></div>
</div>
<p>What is happening here is the following: EOSFactory verifies that the given account exists on the public testnet and associates its random name (in this case <code class="docutils literal"><span class="pre">zk3lmwma5fpb</span></code>) with a variable name (in this case <code class="docutils literal"><span class="pre">account_master</span></code>).</p>
</div>
<div class="section" id="build-the-smart-contract">
<span id="build-the-smart-contract"></span><h2>Build the smart-contract<a class="headerlink" href="#build-the-smart-contract" title="Permalink to this headline">¶</a></h2>
<p>Open the <code class="docutils literal"><span class="pre">eosfactory/contracts/tic_tac_toe_jungle</span></code> folder in VS Code.</p>
<p>First, modify line <code class="docutils literal"><span class="pre">47</span></code> inside  <code class="docutils literal"><span class="pre">src/tic_tac_toe.hpp</span></code> so that it contains the name of the account you created on the testnet in the previous step, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">const</span> <span class="n">account_name</span> <span class="n">code_account</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">zk3lmwma5fpb</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> This is needed as the <code class="docutils literal"><span class="pre">tic_tac_toe</span></code> smart-contract example is bound to a specific account name defined in the header file. You cannot use the default account name <code class="docutils literal"><span class="pre">tic.tac.toe</span></code>, as it cannot be created on a public testnet, so you need to replace it with your own name.</p>
<p>Next, navigate to the <code class="docutils literal"><span class="pre">tic_tac_toe_jungle/build</span></code> folder and run <em>CMake</em> to build the contract:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">..</span>
</pre></div>
</div>
<p>And then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span>
</pre></div>
</div>
</div>
<div class="section" id="prepare-the-unit-test">
<span id="prepare-the-unit-test"></span><h2>Prepare the unit test<a class="headerlink" href="#prepare-the-unit-test" title="Permalink to this headline">¶</a></h2>
<p>Edit the <code class="docutils literal"><span class="pre">test/unittest1.py</span></code> file and in lines <code class="docutils literal"><span class="pre">7</span></code> &amp; <code class="docutils literal"><span class="pre">8</span></code> enter the name and password of the wallet created in the first step, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">wallet_name</span> <span class="o">=</span> <span class="s2">&quot;jungle_wallet&quot;</span>
<span class="n">wallet_pass</span> <span class="o">=</span> <span class="s2">&quot;PW5KDRWrMAev57rfJ8z9FXpRA1tEG4EJ6nsnpVAfYdHRe5WDMnnLz&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="run-the-unit-test">
<span id="run-the-unit-test"></span><h2>Run the unit test<a class="headerlink" href="#run-the-unit-test" title="Permalink to this headline">¶</a></h2>
<p>Finally, open a bash terminal, navigate to the <code class="docutils literal"><span class="pre">tic_tac_toe_jungle</span></code> folder and execute the content of the <code class="docutils literal"><span class="pre">unittest1.py</span></code> file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">test</span><span class="o">/</span><span class="n">unittest1</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This is what the final outcome should look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Ran</span> <span class="mi">1</span> <span class="n">test</span> <span class="ow">in</span> <span class="mf">2.223</span><span class="n">s</span>
<span class="n">OK</span>
</pre></div>
</div>
<p>Please note that line <code class="docutils literal"><span class="pre">9</span></code> of the <code class="docutils literal"><span class="pre">unittest1.py</span></code> file contains an important flag which determines whether contract deployment is included in the unit test setup phase:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">deployment</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Therefore for a subsequent run remember to change this flag to <code class="docutils literal"><span class="pre">False</span></code>, as in EOS smart-contract deployment for a given account is allowed only once (unless the source code is changed and the contract is re-built).</p>
<p>Otherwise you’ll get this error when trying to re-run the test:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">assert</span><span class="p">(</span><span class="ow">not</span> <span class="n">contract</span><span class="o">.</span><span class="n">deploy</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, please note that during the initial run two additional accounts are created on the testnet. Their names are random (to ensure their uniqueness) but in the code they are referred to as <code class="docutils literal"><span class="pre">account_alice</span></code>  and <code class="docutils literal"><span class="pre">account_carol</span></code>. During subsequent runs, those two accounts are re-used.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Tokenika.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.<br/>
    </p>
  </div>
</footer>
  </body>
</html>